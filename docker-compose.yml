version: '3.8'

services:
  redis:
    image: redis:latest
    container_name: redis_yopass
    restart: always
    command: redis-server --appendonly yes
    volumes:
      - /dockers/redis/data:/data
    networks:
      - yopass-network

  yopass:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        BUILDKIT_INLINE_CACHE: 0
        DOCKER_BUILDKIT: 1
        YOPASS_DISABLE_FEATURES_CARDS: 1
    image: turing/yopass
    container_name: yopass
    restart: always
    ports:
      - "1337:1337"
    environment:
      - YOPASS_DISABLE_FEATURES_CARDS=1
    depends_on:
      - redis
    command: [
      "/yopass-server",
      "--database", "redis",
      "--redis", "redis://redis:6379"
    ]
    networks:
      - yopass-network

networks:
  yopass-network:
    driver: bridge
